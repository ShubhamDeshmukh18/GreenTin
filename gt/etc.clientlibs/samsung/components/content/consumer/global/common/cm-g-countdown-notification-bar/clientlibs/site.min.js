(function(){var d=window.sg.common.$q,e=window.sg.common.utils.setFocusNextFocusableEl,l=window.sg.common.utils.getMobileOS,b=function(a){var c=this;this.el={window:d(window),section:d(a)};this.timerId=null;this.isOver99Days=!1;this.timerPlayHide=this.isRu=this.endTimeTxt=this.startTimeTxt=null;this.handler={clickClose:this.closeNotice.bind(this),clickPlayStop:function(a){a.currentTarget.classList.contains("is-play")?c.stopCountdown():c.playCountdown();c.hidePlayStop()},togglePlayStop:function(a){c.el.countEl.hasClass("countdown-notification-bar__timer--hide")||
("focus"===a.type||"mouseenter"===a.type||"click"===a.type?c.el.playStopBtn.parent().addClass("is-show"):"blur"===a.type?requestAnimationFrame(function(){0===c.el.section.find(".countdown-notification-bar__timer-btn-area:hover").target.length&&c.el.playStopBtn.parent().removeClass("is-show")}):c.el.playStopBtn.parent().removeClass("is-show"),c.hidePlayStop())}};b.instances.set(a,this);this.init()};b.numFormat=function(a){a=Number(a).toString();10>Number(a)&&1===a.length&&(a="0"+a);return a};b.dateFormat=
function(a){return null===a||""===a?0:a.substring(0,19)};b.counterData=function(a){a=new Date(a)-new Date;return{day:b.numFormat(Math.floor(a/864E5)),hour:b.numFormat(Math.floor(a%864E5/36E5)),minute:b.numFormat(Math.floor(a%36E5/6E4)),second:b.numFormat(Math.floor(a%6E4/1E3)),distance:a}};b.prototype.setCounter=function(){0!==this.el.countEl.target.length&&(this.startTimeTxt=b.dateFormat(this.el.countEl.attr("data-start-time")),this.endTimeTxt=b.dateFormat(this.el.countEl.attr("data-end-time")),
this.isOver99Days=99<(new Date(this.endTimeTxt)-new Date(this.startTimeTxt))/864E5?!0:!1,this.updateCountdown(),this.isOver99Days?(clearInterval(this.timerId),this.timerId=null,this.setNoCountStyle()):(clearInterval(this.timerId),this.timerId=null,this.timerId=setInterval(this.updateCountdown.bind(this),1E3)))};b.prototype.setNoCountStyle=function(){this.el.countEl.addClass("countdown-notification-bar__timer--hide");this.el.periodEl.removeClass("countdown-notification-bar__period--hide");this.el.playStopWrap.css({display:"none"});
0<this.el.hiddenTxt.target.length&&(this.el.hiddenTxt.remove(),this.el.hiddenTxt=null)};b.prototype.setCountStyle=function(){this.el.countEl.removeClass("countdown-notification-bar__timer--hide");this.el.periodEl.addClass("countdown-notification-bar__period--hide");this.el.playStopWrap.css({display:""});0===this.el.hiddenTxt.target.length&&(this.el.periodEl.target[0].insertAdjacentHTML("afterend",'\x3cp class\x3d"hidden"\x3e\x3c/p\x3e'),this.el.hiddenTxt=this.el.section.find(".countdown-notification-bar__countdown-wrap \x3e .hidden"))};
b.prototype.updateCountdown=function(){var a=this,c=new Date,d=0>new Date(this.startTimeTxt)-c?!0:!1,e=0===parseInt((new Date(this.endTimeTxt)-c)/1E3)?!0:!1;c=0>new Date(this.endTimeTxt)-c?!0:!1;d=d&&!c;var g=b.counterData(this.endTimeTxt);c=this.el.counterNum.eq(0);var f=c.closest(".countdown-notification-bar__timer-wrap").target[0],h=this.el.section.find(".countdown-notification-bar__timer-colon").eq(0).target[0];e&&(f.style.display="",h.style.display="",clearInterval(this.timerId),this.timerId=
null);if(d){if(!this.el.playStopBtn.target[0].classList.contains("is-pause")){this.setCountStyle();var k="";this.el.counterNum.target.forEach(function(b,c){var d=Object.values(g)[c];c=b.nextElementSibling;var e=c.getAttribute("data-text-singular"),f=c.getAttribute("data-text-plural");b.innerText=d;c.innerText=1>=parseInt(d)?e:f;a.isRu=!!c.getAttribute("data-text-ru-first");a.isRu&&(d=parseInt(d.slice(-1)),c.innerText=1===d?c.getAttribute("data-text-ru-first"):1<d&&5>d?c.getAttribute("data-text-ru-second"):
c.getAttribute("data-text-ru-third"));k+=b.innerText+" "+c.innerText+" "});this.el.hiddenTxt.innerHTML(k);"00"!==c.target[0].innerText||e||(f.style.display="none",h.style.display="none")}}else this.setNoCountStyle()};b.prototype.closeNotice=function(){var a=this;this.el.section.hide();clearInterval(this.timerId);this.timerId=null;"ios"===l()?setTimeout(function(){return e(a.el.section.target[0])},200):e(this.el.section.target[0])};b.prototype.playCountdown=function(){this.el.playStopBtn.removeClass("is-pause");
this.el.playStopBtn.addClass("is-play");this.el.playStopBtn.find(".hidden").innerHTML(this.el.playStopBtn.attr("data-text-pause"))};b.prototype.stopCountdown=function(){this.el.playStopBtn.addClass("is-pause");this.el.playStopBtn.removeClass("is-play");this.el.playStopBtn.find(".hidden").innerHTML(this.el.playStopBtn.attr("data-text-play"))};b.prototype.hidePlayStop=function(){var a=this;"mobile"===window.sg.common.utils.getCurrentDevice()&&(clearTimeout(this.timerPlayHide),this.timerPlayHide=setTimeout(function(){a.el.playStopBtn.parent().removeClass("is-show")},
3E3))};b.prototype.setElements=function(){this.el.periodEl=this.el.section.find(".countdown-notification-bar__period");this.el.countEl=this.el.section.find(".countdown-notification-bar__timer");this.el.counterNum=this.el.section.find(".countdown-notification-bar__timer-num");this.el.closeBtn=this.el.section.find(".countdown-notification-bar__close");this.el.hiddenTxt=this.el.section.find(".countdown-notification-bar__countdown-wrap \x3e .hidden");this.el.playStopBtn=this.el.section.find(".countdown-notification-bar__timer-btn-area button");
this.el.playStopWrap=this.el.section.find(".countdown-notification-bar__timer-btn-area")};b.prototype.init=function(){this.setElements();this.setCounter();this.bindEvents()};b.prototype.reInit=function(){this.setElements();this.setCounter();this.bindEvents();clearInterval(this.timerId);this.timerId=null};b.prototype.bindEvents=function(){this.el.closeBtn.off("click",this.handler.clickClose).on("click",this.handler.clickClose);var a=this.el.section.find(".countdown-notification-bar__timer-btn-area");
a.off("mouseenter",this.handler.togglePlayStop).on("mouseenter",this.handler.togglePlayStop);a.off("mouseleave",this.handler.togglePlayStop).on("mouseleave",this.handler.togglePlayStop);a.off("click",this.handler.togglePlayStop).on("click",this.handler.togglePlayStop);this.el.playStopBtn.off("focus",this.handler.togglePlayStop).on("focus",this.handler.togglePlayStop);this.el.playStopBtn.off("blur",this.handler.togglePlayStop).on("blur",this.handler.togglePlayStop);this.el.playStopBtn.off("click",
this.handler.clickPlayStop).on("click",this.handler.clickPlayStop)};var g=function(){d(".countdown-notification-bar").target.forEach(function(a){b.instances.has(a)||new b(a)})};b.instances=new WeakMap;d.ready(g);window.sg.components.CO67CountdownNotificationBar={init:g,reInit:function(){d(".countdown-notification-bar").target.forEach(function(a){b.instances.has(a)?b.instances.get(a).reInit():new b(a)})},closeNotice:function(){d(".countdown-notification-bar").target.forEach(function(a){b.instances.has(a)&&
b.instances.get(a).closeNotice()})}}})();