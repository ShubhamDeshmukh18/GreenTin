(function(){var f=window.sg.common.$q,u=window.sg.common.constants.BREAKPOINTS,x=window.sg.common.utils,h=function(c){var p=this;this.selector={section:".pd-store-locator",filter1depth:".pd-store-locator__filter-1depth \x3e li",filter3depth:".pd-store-locator__filter-3depth",filter2depth:".pd-store-locator__2depth-category",filter1depthResetBtn:".pd-store-locator__reset-cta",gnb:".gnb",searchInput:".pd-store-locator__search-input",searchHeight:".pd-store-locator__search",searchInputClose:".pd-store-locator__search-delete",
searchContents:".pd-store-locator__search-contents",locatorSuggest:".pd-store-locator__suggest",filterOpen:".pd-store-locator__filter-open",filterClose:".pd-store-locator__filter-close, .pd-store-locator__filter-mo-close",filterLayer:".pd-store-locator__filter-layer",filterCateBtn:".pd-store-locator__2depth-toggle",filterCheckbox:'.pd-store-locator__filter-checkbox input[type\x3d"checkbox"]',filterMobileTitle:".pd-store-locator__result-top",result:".pd-store-locator__result",resultBtn:".pd-store-locator__result-item",
detailLayer:".pd-store-locator__detail-layer",detailLayerClose:".detail-close-x",closeOnlyPopUp1:".pd-store-locator__gps-layer",closeOnlyPopUp2:".pd-store-locator__nearby-layer",closeOnlyPopUpBtn1:".pd-store-locator__gps-layer .js-gps-close",closeOnlyPopUpBtn2:".pd-store-locator__nearby-layer .js-nearby-close",closeOnlyPopUpDimm:".s-layer-dimmed"};this.ele={window:f(window),section:f(c),gnb:null,searchInput:null,searchHeight:null,searchInputClose:null,searchContents:null,locatorSuggest:null,filterOpen:null,
filterClose:null,filterLayer:null,filterCateBtn:null,filter1depth:null,filter1depthResetBtn:null,filterCheckbox:null,typ:null,filterMobileTitle:null,result:null,resultBtn:null,detailLayer:null,detailLayerClose:null,closeOnlyPopUpBtn1:null,closeOnlyPopUpBtn2:null,closeOnlyPopUpDimm:null};this.handler={resize:this.resize.bind(this),touchstartFilter:function(c){this.statePc||(c.preventDefault(),c=0<=c.type.indexOf("touch")?c.touches[0].pageY:c.pageY,this.startMobileResult(c),this.ele.filterMobileTitle.off("touchmove",
this.handler.touchMoveFilter).on("touchmove",this.handler.touchMoveFilter),this.ele.filterMobileTitle.off("touchend",this.handler.touchEndFilter).on("touchend",this.handler.touchEndFilter),this.ele.window.off("mousemove",this.handler.touchMoveFilter).on("mousemove",this.handler.touchMoveFilter),this.ele.window.off("mouseup",this.handler.touchEndFilter).on("mouseup",this.handler.touchEndFilter))}.bind(this),touchMoveFilter:function(c){var f=0<=c.type.indexOf("touch")?c.touches[0].pageY:c.pageY;this.moveMobileResult(f);
c.preventDefault()}.bind(this),touchEndFilter:function(){this.endMobileResult();this.ele.filterMobileTitle.off("touchmove",this.handler.touchMoveFilter);this.ele.filterMobileTitle.off("touchend",this.handler.touchEndFilter);this.ele.window.off("mousemove",this.handler.touchMoveFilter);this.ele.window.off("mouseup",this.handler.touchEndFilter)}.bind(this),scroll:function(){p.ele.section.target[0].scrollTop=0}};this.statePc=u.MOBILE<x.getViewPort().width;this.openResultBtn=this.sectionRect=null;this.setProperty();
h.instances.set(c,this);this.init()};h.prototype.setProperty=function(){this.ele.gnb=f(this.selector.gnb);this.ele.searchInput=this.ele.section.find(this.selector.searchInput);this.ele.searchHeight=this.ele.section.find(this.selector.searchHeight);this.ele.searchInputClose=this.ele.section.find(this.selector.searchInputClose);this.ele.searchContents=this.ele.section.find(this.selector.searchContents);this.ele.locatorSuggest=this.ele.section.find(this.selector.locatorSuggest);this.ele.filterOpen=this.ele.section.find(this.selector.filterOpen);
this.ele.filterClose=this.ele.section.find(this.selector.filterClose);this.ele.filterLayer=this.ele.section.find(this.selector.filterLayer);this.ele.filterCateBtn=this.ele.section.find(this.selector.filterCateBtn);this.ele.filter1depth=this.ele.section.find(this.selector.filter1depth);this.ele.filter1depthResetBtn=this.ele.section.find(this.selector.filter1depthResetBtn);this.ele.filterCheckbox=this.ele.section.find(this.selector.filterCheckbox);this.ele.filterMobileTitle=this.ele.section.find(this.selector.filterMobileTitle);
this.ele.result=this.ele.section.find(this.selector.result);this.ele.resultBtn=this.ele.section.find(this.selector.resultBtn);this.ele.detailLayer=this.ele.section.find(this.selector.detailLayer);this.ele.detailLayerClose=this.ele.detailLayer.find(this.selector.detailLayerClose);this.ele.closeOnlyPopUpBtn1=this.ele.section.find(this.selector.closeOnlyPopUpBtn1);this.ele.closeOnlyPopUpBtn2=this.ele.section.find(this.selector.closeOnlyPopUpBtn2);this.ele.closeOnlyPopUpDimm=this.ele.section.find(this.selector.closeOnlyPopUpDimm)};
h.prototype.init=function(){this.bindEvents();this.resize()};h.prototype.reInit=function(){this.setProperty();this.bindEvents();this.resize()};h.prototype.resize=function(){this.statePc=u.MOBILE<x.getViewPort().width;this.resizeFilter(this.statePc);this.setSectionHeight();this.resizeResult(this.statePc)};h.prototype.setSectionHeight=function(){this.ele.section.css({height:x.getViewPort().height-this.ele.gnb.height()+"px"})};h.prototype.toggleLocatorSuggest=function(c){c?(this.ele.searchContents.addClass("is-active"),
this.ele.locatorSuggest.show()):(this.ele.searchContents.removeClass("is-active"),this.ele.locatorSuggest.hide())};h.prototype.resizeFilter=function(c){this.ele.filterLayer.isAnimate()&&this.ele.filterLayer.finish();document.documentElement.classList.contains("pd-store-locator-filter-open")&&(c?(this.ele.filterLayer.css({zIndex:""}),this.ele.result.css({opacity:""})):(this.ele.filterLayer.css({zIndex:parseInt(this.ele.gnb.css("z-index"),0)+100}),this.ele.result.css({opacity:"0"})))};h.prototype.openFilter=
function(){var c=this;this.statePc?(document.documentElement.classList.add("pd-store-locator-filter-open"),this.ele.filterLayer.show()):(document.documentElement.classList.add("pd-store-locator-filter-open"),this.ele.result.css({opacity:"0"}),this.ele.filterLayer.stop().slideDown(300,function(){c.ele.filterLayer.css({display:"block",height:"",overflow:""})}))};h.prototype.closeFilter=function(){var c=this;this.statePc?(document.documentElement.classList.remove("pd-store-locator-filter-open"),this.ele.filterLayer.hide(),
this.ele.filterOpen.focus()):(document.documentElement.classList.remove("pd-store-locator-filter-open"),this.ele.filterLayer.stop().slideUp(300,function(){c.ele.filterLayer.css({display:"none",height:"",overflow:""});c.ele.filterOpen.focus()}),this.ele.result.css({opacity:""}))};h.prototype.toggleFilter2depth=function(c){c=f(c);var p=c.closest("li").find(this.selector.filter3depth);c.hasClass("is-expanded")?(c.removeClass("is-expanded"),c.find("span").target[0].html="Expand",p.stop().slideUp(300,
function(){p.attr("style","");p.hide()})):(c.addClass("is-expanded"),c.find("span").target[0].html="Collapse",p.stop().slideDown(300,function(){p.attr("style","");p.show()}))};h.prototype.chageFilterCheckbox=function(c){var p=f(c);if(0<p.closest("li").find(this.selector.filter2depth).target.length)p.closest("li").find(this.selector.filter3depth).find(this.selector.filter3depth+' input[type\x3d"checkbox"]').target.forEach(function(f){f.checked=c.checked});else{var h=p.closest(this.selector.filter3depth),
r=h.find(this.selector.filter3depth+' input[type\x3d"checkbox"]');h.find(this.selector.filter3depth+' input[type\x3d"checkbox"]:checked').target.length===r.target.length?p.closest(this.selector.filter3depth).parent().find(this.selector.filter2depth+' input[type\x3d"checkbox"]').target[0].checked=!0:p.closest(this.selector.filter3depth).parent().find(this.selector.filter2depth+' input[type\x3d"checkbox"]').target[0].checked=!1}this.setResetFilter()};h.prototype.setResetFilter=function(){var c=this;
this.ele.filter1depth.target.forEach(function(p){p=f(p);var h=p.find(c.selector.filter1depthResetBtn);0<p.find('input[type\x3d"checkbox"]:checked').target.length?(h.removeClass("is-disabled"),h.target[0].disabled=!1):(h.addClass("is-disabled"),h.target[0].disabled=!0)})};h.prototype.resizeResult=function(c){c?(this.ele.result.removeClass("pd-store-locator--result-top"),this.ele.result.removeClass("pd-store-locator--result-bottom"),this.ele.result.removeClass("pd-store-locator--result-active"),this.ele.result.addClass("pd-store-locator--result-middle"),
this.ele.result.target[0].style.top=""):this.ele.result.hasClass("pd-store-locator--result-bottom")&&(this.ele.result.target[0].style.top=this.ele.section.height()-this.ele.filterMobileTitle.target[0].getBoundingClientRect().height+"px")};h.prototype.startMobileResult=function(c){var f=this.ele.section.target[0].getBoundingClientRect();this.sectionRect={startPoint:c,startElTop:this.ele.result.target[0].offsetTop,top:f.top+(document.body.scrollTop||document.documentElement.scrollTop),height:f.height};
this.ele.result.target[0].style.top=this.sectionRect.startElTop+"px";this.ele.result.removeClass("pd-store-locator--result-top");this.ele.result.removeClass("pd-store-locator--result-middle");this.ele.result.removeClass("pd-store-locator--result-bottom");this.ele.result.addClass("pd-store-locator--result-active")};h.prototype.moveMobileResult=function(c){this.ele.result.target[0].style.top=this.sectionRect.startElTop+(c-this.sectionRect.startPoint)+"px"};h.prototype.endMobileResult=function(){var c=
this.ele.searchHeight.height(),f=parseFloat(this.ele.result.target[0].style.top);f<.33*this.sectionRect.height+c?(this.ele.result.addClass("pd-store-locator--result-top"),this.ele.result.target[0].style.top=""):f>.66*this.sectionRect.height+c?(this.ele.result.addClass("pd-store-locator--result-bottom"),this.ele.result.target[0].style.top=this.ele.section.height()-this.ele.filterMobileTitle.target[0].getBoundingClientRect().height+"px"):(this.ele.result.addClass("pd-store-locator--result-middle"),
this.ele.result.target[0].style.top="");this.ele.result.removeClass("pd-store-locator--result-active")};h.prototype.bindEvents=function(){var c=this;this.ele.searchInput.off("keyup").on("keyup",function(){0<c.ele.searchInput.target[0].value.length?c.toggleLocatorSuggest(!0):c.toggleLocatorSuggest(!1)});this.ele.searchInputClose.off("click").on("click",function(){c.ele.searchInput.target[0].value="";c.toggleLocatorSuggest(!1)});this.ele.filterOpen.off("click").on("click",this.openFilter.bind(this));
this.ele.filterClose.off("click").on("click",this.closeFilter.bind(this));this.ele.filterCateBtn.off("click").on("click",function(f){c.toggleFilter2depth(f.currentTarget)});this.ele.filter1depthResetBtn.off("click").on("click",function(h){f(h.currentTarget).closest("li").find('input[type\x3d"checkbox"]:checked').target.forEach(function(c){c.checked=!1});c.setResetFilter()});this.ele.filterCheckbox.off("change").on("change",function(f){c.chageFilterCheckbox(f.currentTarget)});this.ele.resultBtn.off("click").on("click",
function(h){h=f(h.currentTarget);h.hasClass("pd-store-locator--item-disabled")||(c.ele.detailLayer.show(),c.ele.detailLayer.attr("tabindex","0"),c.ele.detailLayer.focus(),c.openResultBtn=h)});this.ele.detailLayerClose.off("click").on("click",function(){c.ele.detailLayer.hide();c.ele.detailLayer.attr("tabindex","");c.openResultBtn.focus();c.openResultBtn=null});this.ele.filterMobileTitle.off("touchstart").on("touchstart",this.handler.touchstartFilter);this.ele.filterMobileTitle.off("mousedown").on("mousedown",
this.handler.touchstartFilter);this.ele.closeOnlyPopUpBtn1.off("click").on("click",function(){c.ele.section.find(c.selector.closeOnlyPopUp1).hide();c.ele.closeOnlyPopUpDimm.hide()});this.ele.closeOnlyPopUpBtn2.off("click").on("click",function(){c.ele.section.find(c.selector.closeOnlyPopUp2).hide();c.ele.closeOnlyPopUpDimm.hide()});if(window.self===window.top)this.ele.window.off("resize",this.handler.resize).on("resize",this.handler.resize);this.ele.section.off("scroll",this.handler.scroll).on("scroll",
this.handler.scroll)};h.instances=new WeakMap;window.sg.components.pfStoreLocator={reInit:function(){f(".pd-store-locator").target.forEach(function(c){h.instances.has(c)&&h.instances.get(c).reInit()})}};f.ready(function(){f(".pd-store-locator").target.forEach(function(c){h.instances.has(c)||new h(c)})})})();
(function(f,u,x){function h(){for(var c=d.meta("distances").split(/\s*,\s*/),k=[],h=0;h<c.length;h++)k.push(parseInt(c[h]));d.config={siteCode:d.meta("siteCode"),isRTL:"Y"===f("#rtlflagYn").val(),distanceUnit:d.meta("distanceUnit"),distanceUnitDisplay:"3959"===d.meta("distanceUnit")?"mile":"km",latitude:d.meta("latitude"),longitude:d.meta("longitude"),distances:k,defaultStoreTypes:d.meta("restrictedStoreTypes")||"",hatchRegion:d.meta("hatchRegion"),hatchStorelocatorUseYN:d.meta("hatchStorelocatorUseYN"),
hatchStorelocatorBrandID:d.meta("hatchStorelocatorBrandID"),hatchStorelocatorUrl:d.meta("hatchStorelocatorUrl"),hatchStorelocatorStoreType:d.meta("hatchStorelocatorStoreType"),hatchStorelocatorMaxCount:d.meta("hatchStorelocatorMaxCount"),hatchStorelocatorLang:d.meta("hatchStorelocatorLang"),distanceDefault:d.meta("distanceDefault"),distanceNearby:d.meta("distanceNearby")};c=d.$ui.find(".sdf-comp-control-panel");d.$ui.controlPanel=c;k=c.find(".sdf-comp-search-panel");d.$ui.search={panel:k,input:k.find("input#store-search"),
button:k.find("button.search-store-button"),reset:k.find("button.pd-store-locator__search-delete")};k=c.find(".sdf-comp-suggest-panel");d.$ui.suggest={panel:k,listPanel:k.find(".sdf-comp-suggest-list-panel")};k=c.find(".sdf-comp-filter-panel");d.$ui.filter={panel:k,filterCount:k.find(".sdf-comp-result-count-panel strong"),resetCategoriesButton:k.find("button.sdf-comp-reset-categories"),categoryFilterPanel:k.find(".sdf-comp-category-filter-panel"),resetStoresButton:k.find("button.sdf-comp-reset-stores"),
storeFilterPanel:k.find(".sdf-comp-store-filter-panel"),findStoreCta:k.find("a.cta.js-find-store")};k=c.find(".sdf-comp-result-panel");d.$ui.result={panel:k,storeCountPanel:k.find(".sdf-comp-store-result-count-panel"),storeListPanel:k.find(".sdf-comp-store-list-panel"),noResultPanel:k.find(".sdf-comp-no-result-panel"),hidden:{maxLat:k.find("input#maxLat"),minLat:k.find("input#minLat"),maxLong:k.find("input#maxLong"),minLong:k.find("input#minLong"),storeListNullYn:k.find("input#store_list_nullYn"),
storeLength:k.find("input#storelength")}};d.$ui.layer={modalMask:d.$ui.find(".s-layer-dimmed"),detailPopup:d.$ui.find(".store_locator-ly-pop.sdf-comp-detail-panel"),tooltipPopup:d.$ui.find(".store_locator-ly-pop.sdf-comp-tooltip-panel"),gpsPopup:d.$ui.find(".store_locator-ly-pop.sdf-comp-gps-panel"),nearbyPopup:d.$ui.find(".store_locator-ly-pop.sdf-comp-nearby-panel")};d.meta("siteCode");d.$ui.layer.detailPopup.disclaimer=Granite.I18n.get("Information on this page is subject to change without prior notice. Stock availability and prices will vary, so please contact the retailer directly for up to date information.");
d.$ui.gmapPanel=d.$ui.find("#map-canvas");d.gmap={map:null,markers:[],location:null,ctx:{gpsLatitude:null,gpsLongitude:null,gpsEnabled:!1,nearby:"N",tooltipActivated:!1,autocompleteLatitude:null,autocompleteLongitude:null,searchLatitude:null,searchLongitude:null,draggedLatitude:null,draggedLongitude:null},cachedDetailContents:new Map,filterReady:!1};Object.getPrototypeOf(d).getCurrentRadius=function(){return null!==d.config.distanceDefault&&""!==d.config.distanceDefault&&void 0!==d.config.distanceDefault&&
null!==d.config.distanceNearby&&""!==d.config.distanceNearby&&void 0!==d.config.distanceNearby?this.gmap.ctx.gpsEnabled?"Y"!==this.gmap.ctx.nearby?d.config.distanceDefault:d.config.distanceNearby:d.config.distanceNearby:this.gmap.ctx.gpsEnabled?"Y"!==this.gmap.ctx.nearby?5:10:10};d.$ui.controlPanel.hide();d.$ui.gmapPanel.hide();d.init()}function c(){var h=d.config.latitude,k=d.config.longitude,D=f.trim(r("gpsOK"));d.gmap.ctx.gpsEnabled="true"===D;if(""===D){d.$ui.layer.modalMask.show();var y=d.$ui.layer.gpsPopup;
y.find(".cta.js-gps-approval").off("click").on("click",function(){B("true");d.$ui.layer.modalMask.hide();y.hide();c()});y.find(".cta.js-gps-close, .pd-store-locator__gps-close-cta.js-gps-close").off("click").on("click",function(){B("false");d.$ui.layer.modalMask.hide();p(h,k);y.hide()});y.show()}else d.gmap.ctx.gpsEnabled?C():p(h,k)}function p(c,f,h){var k=d.config;c=new google.maps.LatLng(c,f);d.gmap.location=c;d.gmap.initialLocation=c;var n=d.getCurrentRadius();f=15;n="string"===typeof n?parseInt(n):
n;1>=n?f=15:1<n&&2>=n?f=14:2<n&&5>=n?f=13:5<n&&10>=n?f=12:10<n&&25>=n?f=11:25<n&&50>=n?f=10:50<n&&(f=9);n=k.isRTL?google.maps.ControlPosition.LEFT_TOP:google.maps.ControlPosition.RIGHT_TOP;n=d.gmap.mapOptions={scaleControl:!0,scaleControlOptions:{position:google.maps.ControlPosition.BOTTOM_CENTER},mapTypeControl:!1,panControl:!0,panControlOptions:{position:n},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:n},streetViewControl:!1,streetViewControlOptions:{position:n},
center:c,zoom:f,mapTypeId:google.maps.MapTypeId.ROADMAP};(f=d.gmap.map)?(f.setCenter(c),f.setZoom(n.zoom)):f=d.gmap.map=new google.maps.Map(d.$ui.gmapPanel.get(0),n);d.gmap.infowindow=new google.maps.InfoWindow;k=k.isRTL?google.maps.ControlPosition.TOP_LEFT:google.maps.ControlPosition.TOP_RIGHT;f.getStreetView().setOptions({addressControlOptions:{position:google.maps.ControlPosition.TOP_CENTER},panControlOptions:{position:k},zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE,position:k},
FullScreenAddressControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},visible:!1});d.gmap.ctx.gpsEnabled&&(k=d.gmap.ctx.gpsLatitude,c=d.gmap.ctx.gpsLongitude,d.gmap.gpsMarker=new google.maps.Marker({position:new google.maps.LatLng(k,c),map:f}),d.gmap.gpsCircle=new google.maps.Circle({map:f,center:new google.maps.LatLng(k,c),radius:500,fillColor:"#FF0000",fillOpacity:.25,strokeColor:"#FF0000",strokeOpacity:.35,strokeWeight:1}));h||(d.notify("onReady"),d.$ui.controlPanel.show(),d.$ui.gmapPanel.show())}
function B(c){d.gmap.ctx.gpsEnabled="true"===c;var f=new Date;f.setTime(f.getTime()+432E6);document.cookie="gpsOK\x3d"+c+"; expires\x3d"+f.toUTCString()}function r(c){c+="\x3d";for(var f=document.cookie.split(";"),d,h=0,n=f.length;h<n;h++){for(d=f[h];" "===d.charAt(0);)d=d.substring(1);if(-1!==d.indexOf(c))return d.substring(c.length,d.length)}return""}function C(){function c(c){var f="undefined"!==typeof c.coords?c.coords.latitude:c.latitude;c="undefined"!==typeof c.coords?c.coords.longitude:c.longitude;
if(!f||!c||isNaN(f)||isNaN(c))f=d.config.latitude,c=d.config.longitude;d.gmap.ctx.gpsLatitude=f;d.gmap.ctx.gpsLongitude=c;p(f,c)}function h(c){B("false");p(d.config.latitude,d.config.longitude)}function r(){console.warn("[PDD08] Geolocation error")}navigator.geolocation?navigator.geolocation.getCurrentPosition(c,h):f.getJSON("http://freegeoip.net/json/?callback\x3d?").then(c,r)}var d=null;f(function(){0<f(".pd-store-locator.sdf-dynamic-component").length&&(d=x.dispatch(".pd-store-locator.sdf-dynamic-component"))&&
(window.storeLocator=d,h(),c())})})(jQuery,window.sg.components.pfStoreLocator,window.sg.sdf.comp);
(function(f,u,x){function h(a,l,m){if("Y"===b.config.hatchStorelocatorUseYN){b.listRequest&&b.listRequest.abort();var e=[],c={columnName:"storeTypes",operation:"equal",value:[]};if(null!=b.config.defaultStoreTypes&&""!=b.config.defaultStoreTypes&&void 0!=b.config.defaultStoreTypes)if(-1<b.config.defaultStoreTypes.indexOf(",")?e=b.config.defaultStoreTypes.split(","):e.push(b.config.defaultStoreTypes),0==a.filters.length){for(var g=0;g<e.length;g++)c.value.push(e[g]);a.filters.push(c)}else if(1==a.filters.length)if("productTags"==
a.filters[0].columnName){for(g=0;g<e.length;g++)c.value.push(e[g]);a.filters.push(c)}else{if("storeTypes"==a.filters[0].columnName){c=a.filters[0].value;a.filters[0].value=[];for(g=0;g<e.length;g++)c.push(e[g]);a.filters[0].value=c.reduce(function(b,a){0>b.indexOf(a)&&b.push(a);return b},[])}}else if(2==a.filters.length){c=a.filters[0].value;a.filters[0].value=[];for(g=0;g<e.length;g++)c.push(e[g]);a.filters[0].value=c.reduce(function(b,a){0>b.indexOf(a)&&b.push(a);return b},[])}b.listRequest=f.ajax({headers:{"Cache-Control":"no-cache",
"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},url:v+"/geo/list",data:JSON.stringify(a),type:"POST",dataType:"json",async:void 0!==m?m:!0,success:function(a){b.listRequest=void 0;a&&a.response&&(a=a.response);a&&a.locations?l&&l.call(null,a):(console.error("[PDD08] HATCH API failure"),console.dir(a))},error:function(){b.listRequest=void 0;console.error("[PDD08] HATCH Can't retrieve location list from '"+v+"/geo/list'")}})}else b.listRequest&&b.listRequest.abort(),a.shopTypeList&&
""!==a.shopTypeList||(a.shopTypeList=b.config.defaultStoreTypes),b.listRequest=f.ajax({url:v+"/b2c/storelocator/list",data:a,type:"GET",dataType:"json",async:void 0!==m?m:!0,success:function(a){b.listRequest=void 0;a&&a.response&&(a=a.response);a&&a.statusCode&&200===a.statusCode&&a.resultData?l&&l.call(null,a.resultData):(console.error("[PDD08] Search API failure"),console.dir(a))},error:function(){b.listRequest=void 0;console.error("[PDD08] Can't retrieve location list from '"+v+"/b2c/storelocator/list'")}})}
function c(a,l,m){b.listRequestFilter&&b.listRequestFilter.abort();a.shopTypeList&&""!==a.shopTypeList||(a.shopTypeList="test");b.listRequestFilter=f.ajax({url:H+"/b2c/storelocator/list",data:a,type:"GET",dataType:"json",async:void 0!==m?m:!0,success:function(a){b.listRequestFilter=void 0;a&&a.response&&(a=a.response);a&&a.statusCode&&200===a.statusCode&&a.resultData?l&&l.call(null,a.resultData):(console.error("[PDD08] searchapi filter Search API failure"),console.dir(a))},error:function(){b.listRequestFilter=
void 0;console.error("[PDD08] HATCH searchapi filter Can't retrieve location list from '"+H+"/b2c/storelocator/list'")}})}function p(a,l){"Y"===b.config.hatchStorelocatorUseYN?f.ajax({headers:{"Cache-Control":"no-cache","Content-Type":"application/json","Access-Control-Allow-Origin":"*"},url:v+"/geo/list",data:JSON.stringify(a),type:"POST",dataType:"json",success:function(a){a&&a.response&&(a=a.response);a&&a.locations?l&&l.call(null,a):(console.error("[PDD08] HATCH API failure"),console.dir(a))},
error:function(){console.error("[PDD08] HATCH Can't retrieve location detail-info from '"+v+"/geo/list'")}}):f.ajax({url:v+"/b2c/storelocator/detail",data:a,type:"GET",dataType:"json",success:function(a){a&&a.response&&(a=a.response);a&&a.statusCode&&200===a.statusCode&&a.resultData?l&&l.call(null,a.resultData):(console.error("[PDD08] Search API failure"),console.dir(a))},error:function(){console.error("[PDD08] Can't retrieve location detail-info from '"+v+"/b2c/storelocator/detail'")}})}function B(a,
l){var m=b.gmap.markers[a];if(m){var e=m.store,c=b.gmap.location,g=a=null;null!==b.gmap.ctx.draggedLatitude&&null!==b.gmap.ctx.draggedLongitude?(a=b.gmap.ctx.draggedLatitude,g=b.gmap.ctx.draggedLongitude):null!==b.gmap.ctx.gpsLatitude&&null!==b.gmap.ctx.gpsLongitude?null!==b.gmap.ctx.autocompleteLatitude&&null!==b.gmap.ctx.autocompleteLongitude?(a=b.gmap.ctx.autocompleteLatitude,g=b.gmap.ctx.autocompleteLongitude):null!==b.gmap.ctx.searchLatitude&&null!==b.gmap.ctx.searchLongitude?(a=b.gmap.ctx.searchLatitude,
g=b.gmap.ctx.searchLongitude):(a=b.gmap.ctx.gpsLatitude,g=b.gmap.ctx.gpsLongitude):null!==b.gmap.ctx.autocompleteLatitude&&null!==b.gmap.ctx.autocompleteLongitude?(a=b.gmap.ctx.autocompleteLatitude,g=b.gmap.ctx.autocompleteLongitude):null!==b.gmap.ctx.searchLatitude&&null!==b.gmap.ctx.searchLongitude?(a=b.gmap.ctx.searchLatitude,g=b.gmap.ctx.searchLongitude):(a=b.config.latitude,g=b.config.longitude);e.detailReady&&e.lastLat===c.lat()&&e.lastLng===c.lng()?l.call(m,e):(a="Y"===b.config.hatchStorelocatorUseYN?
null!=b.config.hatchStorelocatorLang&&""!=b.config.hatchStorelocatorLang&&void 0!=b.config.hatchStorelocatorLang?{countryCode:b.config.hatchRegion,geoCenterArea:{center:{latitude:a,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},segment:b.config.hatchStorelocatorLang,filters:[{columnName:"searchableId",operation:"equal",value:[e.id]}]}:{countryCode:b.config.hatchRegion,geoCenterArea:{center:{latitude:a,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},filters:[{columnName:"searchableId",
operation:"equal",value:[e.id]}]}:{siteCode:b.config.siteCode,distanceUnit:b.config.distanceUnit,nRadius:b.getCurrentRadius(),latitude:a,longitude:g,storeId:e.id},p(a,function(a){if("Y"===b.config.hatchStorelocatorUseYN){var g=a.locations[0];g||(console.warn("[PDD08] HATCH Shop detail information is empty"),console.dir({resultData:a}),g=e);var d=g.storeTypes;if(null!==d&&void 0!==d)if(d=g.storeTypes[0],"1_ses"===d){var z=q.get("E")||"other";var h=Granite.I18n.get("Experience Store")}else"2_sbs"===
d?(z=q.get("B")||"other",h=Granite.I18n.get("Brand Store")):"3_retailer_store"===d?(z=q.get("O")||"other",h=Granite.I18n.get("Others Store")):""===d&&(z=q.get("O")||"other",h=Granite.I18n.get("Others Store"));else z=q.get("O")||"other";d=g.distance;d="mile"===b.config.distanceUnitDisplay?(parseFloat(d)/1609.344).toFixed(2):(parseFloat(d)/1E3).toFixed(2);var k=[];g.address.street&&k.push(g.address.street);g.locality&&k.push(g.locality);g.address.zip&&k.push(g.address.zip);var E=f.trim(g.noticeMsg);
E=""!==E?Granite.I18n.get(E):b.$ui.layer.detailPopup.disclaimer;m.store=e=f.extend(e,g,{taggingName:w(g.name.toLowerCase()),brandTypeEngName:z,brandType:h,distance:d,tooltipInfoEnabled:""!==f.trim(g.telephone)||""!==f.trim(g.email)||""!==f.trim(g.website),fullAddress:k.join(", "),groupList:O(a.locations[0].productTags),detailReady:!0,lastLat:c.lat(),lastLng:c.lng(),noticeMsg:E})}else{g=a.storeDetail;g||(console.warn("[PDD08] Shop detail information is empty"),console.dir({resultData:a}),g=e);z=q.get(g.brandTypeCode)||
"other";h=f.trim(g.distance);if(""===h||"0"===h)h=e.distance;d=[];g.address&&d.push(g.address);g.cityName&&d.push(g.cityName);g.postalCode&&d.push(g.postalCode);k=f.trim(g.noticeMsg);k=""!==k?Granite.I18n.get(k):b.$ui.layer.detailPopup.disclaimer;m.store=e=f.extend(e,g,{taggingName:w(g.name.toLowerCase()),brandTypeEngName:z,brandType:Granite.I18n.get(g.brandType),distance:h,tooltipInfoEnabled:""!==f.trim(g.phone)||""!==f.trim(g.email)||""!==f.trim(g.homepageUrl),fullAddress:d.join(", "),groupList:L(a.categories),
detailReady:!0,lastLat:c.lat(),lastLng:c.lng(),noticeMsg:k})}l.call(m,e)}))}else console.error("[PDD08] Marker not prepared for index '"+a+"'")}function r(a){var l=b.config,m=M(b.$ui.filter.categoryFilterPanel.find("input[name\x3d'categoryFilter']:checked")),e=M(b.$ui.filter.storeFilterPanel.find("input[name\x3d'storeTypeFilter']:checked")),c=null,g=null;a?(c=b.gmap.location.lat(),g=b.gmap.location.lng(),b.gmap.ctx.draggedLatitude=c,b.gmap.ctx.draggedLongitude=g):null!==b.gmap.ctx.gpsLatitude&&null!==
b.gmap.ctx.gpsLongitude?null!==b.gmap.ctx.autocompleteLatitude&&null!==b.gmap.ctx.autocompleteLongitude?(c=b.gmap.ctx.autocompleteLatitude,g=b.gmap.ctx.autocompleteLongitude):null!==b.gmap.ctx.searchLatitude&&null!==b.gmap.ctx.searchLongitude?(c=b.gmap.ctx.searchLatitude,g=b.gmap.ctx.searchLongitude):(c=b.gmap.ctx.gpsLatitude,g=b.gmap.ctx.gpsLongitude):null!==b.gmap.ctx.autocompleteLatitude&&null!==b.gmap.ctx.autocompleteLongitude?(c=b.gmap.ctx.autocompleteLatitude,g=b.gmap.ctx.autocompleteLongitude):
null!==b.gmap.ctx.searchLatitude&&null!==b.gmap.ctx.searchLongitude?(c=b.gmap.ctx.searchLatitude,g=b.gmap.ctx.searchLongitude):(c=b.config.latitude,g=b.config.longitude);if("Y"===l.hatchStorelocatorUseYN)if(null!=l.hatchStorelocatorLang&&""!=l.hatchStorelocatorLang&&void 0!=l.hatchStorelocatorLang)if(""!=m&&""!=e){var f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},segment:l.hatchStorelocatorLang,filters:[{columnName:"storeTypes",
operation:"equal",value:[]},{columnName:"productTags",operation:"equal",value:[]}]};if(0<m.length)for(a=0;a<m.length;a++)f.filters[1].value.push(m[a]);if(0<e.length)for(a=0;a<e.length;a++)f.filters[0].value.push(e[a])}else if(""!=m&&""==e){if(f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},segment:l.hatchStorelocatorLang,filters:[{columnName:"productTags",operation:"equal",value:[]}]},0<m.length)for(a=0;a<m.length;a++)f.filters[0].value.push(m[a])}else if(""==
m&&""!=e){if(f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},segment:l.hatchStorelocatorLang,filters:[{columnName:"storeTypes",operation:"equal",value:[]}]},0<e.length)for(a=0;a<e.length;a++)f.filters[0].value.push(e[a])}else""==m&&""==e&&(f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},segment:l.hatchStorelocatorLang,filters:[]});else if(""!=m&&""!=e){f=
{countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},filters:[{columnName:"storeTypes",operation:"equal",value:[]},{columnName:"productTags",operation:"equal",value:[]}]};if(0<m.length)for(a=0;a<m.length;a++)f.filters[1].value.push(m[a]);if(0<e.length)for(a=0;a<e.length;a++)f.filters[0].value.push(e[a])}else if(""!=m&&""==e){if(f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},
filters:[{columnName:"productTags",operation:"equal",value:[]}]},0<m.length)for(a=0;a<m.length;a++)f.filters[0].value.push(m[a])}else if(""==m&&""!=e){if(f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*parseInt(b.getCurrentRadius())},filters:[{columnName:"storeTypes",operation:"equal",value:[]}]},0<e.length)for(a=0;a<e.length;a++)f.filters[0].value.push(e[a])}else""==m&&""==e&&(f={countryCode:l.hatchRegion,geoCenterArea:{center:{latitude:c,longitude:g},distance:1E3*
parseInt(b.getCurrentRadius())},filters:[]});else f={siteCode:l.siteCode,distanceUnit:l.distanceUnit,latitude:c,longitude:g,nRadius:b.getCurrentRadius(),categoryList:m,shopTypeList:e};h(f,function(a){var c=A(a);d(a,c);!isNaN(c)&&0<c?"Y"===l.hatchStorelocatorUseYN&&""===m&&""===e&&I(a):J(f);b.gmap.ctx.tooltipActivated=!1;u.reInit()})}function C(){var a=P(b.$ui.search.input.val());if(""===a)b.gmap.location=b.gmap.initialLocation,b.gmap.map.setCenter(b.gmap.location),r();else{a={googlepath:"//maps.googleapis.com/maps/api/geocode/json",
sensor:!1,address:encodeURIComponent(a)};if("ae"==b.config.siteCode||"ae_ar"==b.config.siteCode)a.bounds="12.051522,42.418151|31.636788,60.990962";f.ajax({url:"/aemapi/v6/storelocator/getSignature",data:a,dataType:"json",success:function(a){a&&200===a.statusCode?f.ajax({url:a.resultData.signatureUrl,success:function(a){a&&a.results&&0!==a.results.length&&((a=a.results[0])&&"undefined"!==a&&(a=a.geometry.location)&&(b.gmap.map.setCenter(a),b.gmap.ctx.autocompleteLatitude=null,b.gmap.ctx.autocompleteLongitude=
null,b.gmap.ctx.draggedLatitude=null,b.gmap.ctx.draggedLongitude=null,b.gmap.ctx.searchLatitude=a.lat,b.gmap.ctx.searchLongitude=a.lng),b.$ui.suggest.panel.hide(),r())}}):console.warn("[PDD08] Signature API call failure")}})}}function d(a,c){var l={count:c,storeList:Q(a)};b.data={storeList:[],storeMap:{}};b.$ui.filter.filterCount.text(c);var e=b.$ui.result;b.invokeTemplate("resultCount",l,e.storeCountPanel.empty().get(0));b.invokeTemplate("storeItem",l,e.storeListPanel.empty().get(0));e.storeListPanel.find("li \x3e a").on("click",
function(a){a=f(this).find(".store-info").attr("data-store-index");G(a,!0)});a=a.geoInfo;e=e.hidden;a&&(e.minLat.val(a.minLatitude),e.maxLat.val(a.maxLatitude),e.minLong.val(a.minLongitude),e.maxLong.val(a.maxLongitude));e.storeListNullYn.val("N");e.storeLength.val(c);c=D();for(e=0;e<l.storeList.length;e++){a=l.storeList[e];var d=y(a,e);c.push(d);b.data.storeList.push(a);b.data.storeMap[a.id]=a}b.$ui.result.panel.removeClass("s-no-data");b.gmap.ctx.nearby="N";b.notify("storeListLoaded",b.data.storeList);
k(b.$ui.result.panel.get(0));u.reInit()}function G(a,c){var l=b.$ui.layer.detailPopup;l.currentStore&&l.currentStore.index===a||B(a,function(e){var m=l.empty().get(0);b.invokeTemplate("detailLayerPanel",{store:e},m);l.find(".detail-close-x").on("click",l.closePopup);c&&google.maps.event.trigger(b.gmap.markers[a],"click");l.currentStore=e;b.notify("storeDetailOpen",e);k(m)})}function k(a){window.sg.common.icon.update(a||b.rootElement)}function D(){var a=b.gmap.markers;if(0<a.length){for(var c=0;c<
a.length;c++)a[c].setMap(null);a.length=0}return a}function y(a,c){var l=new google.maps.MarkerImage("/etc.clientlibs/samsung/clientlibs/consumer/global/clientlib-common/resources/images/icon-pin-"+q.get(a.brandTypeCode)+".svg");l=new google.maps.Marker({position:new google.maps.LatLng(a.latitude,a.longitude),map:b.gmap.map,labelContent:(c+1).toString(),icon:l});l.store=a;l.index=c;n(l);return l}function n(a){a.addListener("click",function(a){a&&a.latLng&&b.gmap.map.setCenter(a.latLng)});google.maps.event.clearListeners(a,
"click");google.maps.event.addListener(a,"click",function(c){b.gmap.ctx.tooltipActivated=!0;B(a.index,function(c){var e=b.$ui.layer.tooltipPopup.empty(),g=e.get(0);b.invokeTemplate("storeTooltip",{store:c},g);var l=b.gmap.infowindow;l.setContent(e.html());l.open(b.gmap.map,a);setTimeout(function(){var a=b.$ui.gmapPanel,e=a.find("button.gm-ui-hover-effect");e.attr({"an-tr":b.meta("taggingPrefix")+"-text-button","an-ca":"store locator","an-ac":"store detail view","an-la":"store detail view:close"});
e.on("click",function(){b.gmap.ctx.tooltipActivated=!1;b.$ui.layer.detailPopup.closePopup();b.$ui.result.storeListPanel.find("li:eq("+c.index+") .pd-store-locator__result-item").removeClass("is-active")});a.find("button.sg-gmap-pin-title-button").off("click").on("click",function(a){a=f(a.target).attr("data-store-index");b.$ui.layer.detailPopup.openPopup(a)})},100);k(g)});var l=a.store;c=c&&c.latLng?c.latLng:new google.maps.LatLng(l.latitude,l.longitude);b.gmap.map.setCenter(c);c=b.$ui.result.storeListPanel;
c.find(".pd-store-locator__result-item").removeClass("is-active");c.find("li:eq("+l.index+") .pd-store-locator__result-item").addClass("is-active")})}function J(a){var c=b.gmap.ctx,m=b.$ui.result;m.panel.addClass("s-no-data");m.hidden.storeListNullYn.val("Y");m.hidden.storeLength.val("0");c.gpsEnabled&&""!==f.trim(b.$ui.search.input.val())&&"N"===c.nearby&&R(a)}function M(a){var c=[];a.each(function(a,e){"Y"===b.config.hatchStorelocatorUseYN&&"storeTypeFilter"===e.name?"E"==e.value?c.push("1_ses"):
"B"==e.value?c.push("2_sbs"):"O"==e.value&&c.push("3_retailer_store"):c.push(e.value)});return"Y"===b.config.hatchStorelocatorUseYN?c:c.join(",")}function Q(a){var c=[];if("Y"===b.config.hatchStorelocatorUseYN){if((a=a.locations)&&0<a.length)for(var d=0;d<a.length;d++){var e=a[d],h=e.storeTypes,g=void 0;null!==h&&void 0!==h?(h=e.storeTypes[0],"1_ses"===h?(g=f.extend({index:d,taggingName:w(e.name.toLowerCase()),brandTypeEngName:q.get("E")||"other",distanceUnitDisplay:b.config.distanceUnitDisplay,disabled:!1},
e),g.brandType=Granite.I18n.get("Experience Store"),g.brandTypeCode="E"):"2_sbs"===h?(g=f.extend({index:d,taggingName:w(e.name.toLowerCase()),brandTypeEngName:q.get("B")||"other",distanceUnitDisplay:b.config.distanceUnitDisplay,disabled:!1},e),g.brandType=Granite.I18n.get("Brand Store"),g.brandTypeCode="B"):"3_retailer_store"===h?(g=f.extend({index:d,taggingName:w(e.name.toLowerCase()),brandTypeEngName:q.get("O")||"other",distanceUnitDisplay:b.config.distanceUnitDisplay,disabled:!1},e),g.brandType=
Granite.I18n.get("Others Store"),g.brandTypeCode="O"):""===h&&(g=f.extend({index:d,taggingName:w(e.name.toLowerCase()),brandTypeEngName:q.get("O")||"other",distanceUnitDisplay:b.config.distanceUnitDisplay,disabled:!1},e),g.brandType=Granite.I18n.get("Others Store"),g.brandTypeCode="O")):(g=f.extend({index:d,taggingName:w(e.name.toLowerCase()),brandTypeEngName:q.get("O")||"other",distanceUnitDisplay:b.config.distanceUnitDisplay,disabled:!1},e),g.brandType=Granite.I18n.get("Others Store"),g.brandTypeCode=
"O");g.id=e.searchableId;g.address=e.address.street+", "+e.address.zip;g.cityName=e.locality;g.latitude=e.coordinates.latitude;g.longitude=e.coordinates.longitude;g.homepageUrl=e.website;g.phone=e.telephone;null!=e.customFields&&void 0!=e.customFields&&(null!=e.customFields.store_pickup&&void 0!=e.customFields.store_pickup&&"yes"==e.customFields.store_pickup[0]&&(g.custombopis=Granite.I18n.get("Store Pickup")),null!=e.customFields.online_order&&void 0!=e.customFields.online_order&&"yes"==e.customFields.online_order[0]&&
(g.customea=Granite.I18n.get("Online Order")));g.distance="mile"===b.config.distanceUnitDisplay?(parseFloat(e.distance)/1609.344).toFixed(2):(parseFloat(e.distance)/1E3).toFixed(2);c.push(g)}}else if((a=a.stores)&&0<a.length)for(d=0;d<a.length;d++)e=a[d],h=e.brandTypeCode,h=f.extend({index:d,taggingName:w(e.name.toLowerCase()),brandTypeEngName:q.get(h)||"other",distanceUnitDisplay:b.config.distanceUnitDisplay,disabled:!1},e),h.brandType=Granite.I18n.get(e.brandType),c.push(h);return c}function R(a){null!==
b.config.hatchStorelocatorUseYN&&""!==b.config.hatchStorelocatorUseYN&&void 0!==b.config.hatchStorelocatorUseYN?(a.geoCenterArea.distance=null!==b.config.distanceNearby&&""!==b.config.distanceNearby&&void 0!==b.config.distanceNearby?b.config.distanceNearby:1E4,h(a,function(a){a=A(a);if(!isNaN(a)&&0<a){b.$ui.layer.modalMask.show();var c=b.$ui.layer.nearbyPopup;c.find(".cta.js-nearby-approval").off("click").on("click",function(){b.gmap.ctx.nearby="Y";b.$ui.layer.modalMask.hide();r();c.hide()});c.find(".cta.js-nearby-close").off("click").on("click",
function(){b.gmap.ctx.nearby="N";b.$ui.layer.modalMask.hide()});c.show()}})):null!==b.config.distanceNearby&&""!==b.config.distanceNearby&&void 0!==b.config.distanceNearby?h(f.extend({},a,{nRadius:b.config.distanceNearby}),function(a){a=A(a);if(!isNaN(a)&&0<a){b.$ui.layer.modalMask.show();var c=b.$ui.layer.nearbyPopup;c.find(".cta.js-nearby-approval").off("click").on("click",function(){b.gmap.ctx.nearby="Y";b.$ui.layer.modalMask.hide();r();c.hide()});c.find(".cta.js-nearby-close").off("click").on("click",
function(){b.gmap.ctx.nearby="N";b.$ui.layer.modalMask.hide()});c.show()}},!1):h(f.extend({},a,{nRadius:"10"}),function(a){a=A(a);if(!isNaN(a)&&0<a){b.$ui.layer.modalMask.show();var c=b.$ui.layer.nearbyPopup;c.find(".cta.js-nearby-approval").off("click").on("click",function(){b.gmap.ctx.nearby="Y";b.$ui.layer.modalMask.hide();r();c.hide()});c.find(".cta.js-nearby-close").off("click").on("click",function(){b.gmap.ctx.nearby="N";b.$ui.layer.modalMask.hide()});c.show()}},!1)}function A(a){return"Y"===
b.config.hatchStorelocatorUseYN?a.locations&&0<a.locations.length?parseInt(a.locations.length):"0":a.common&&a.common.storesCount?parseInt(a.common.storesCount):NaN}function P(a){var c=a=f.trim(a);if(""!==a)if("ru"===b.config.siteCode&&0<=a.indexOf("\u0443\u043b. \u0422\u0432\u0435\u0440\u0441\u043a\u0430\u044f, 22"))c="\u041c\u043e\u0441\u043a\u0432\u0430 "+a;else if(/^[0-9|-]+$/.test(a)&&!isNaN(a)){var d=S[b.config.siteCode];d&&(c=d+" "+a)}return c}function T(){var a=new google.maps.places.AutocompleteService;
b.gmap.ctx.autocompleteLatitude=null;b.gmap.ctx.autocompleteLongitude=null;b.gmap.ctx.searchLatitude=null;b.gmap.ctx.searchLongitude=null;b.gmap.ctx.draggedLatitude=null;b.gmap.ctx.draggedLongitude=null;b.$ui.search.input.off("keyup").on("keyup",function(c){13===c.which?C():(c=f(c.currentTarget).val(),""===c?(b.$ui.search.panel.removeClass("is-active"),b.$ui.suggest.panel.hide(),K("no")):(b.$ui.suggest.panel.show(),b.$ui.search.panel.addClass("is-active"),a.getPlacePredictions({input:c},U)))});b.$ui.search.button.off("click").on("click",
function(a){C()})}function U(a,c){if(c!==google.maps.places.PlacesServiceStatus.OK)b.$ui.suggest.panel.hasClass("s-no-suggest")||b.$ui.suggest.panel.addClass("s-no-suggest"),K("no");else{K("yes");b.$ui.suggest.panel.removeClass("s-no-suggest");var d=[];a.forEach(function(a,b){var c=function(a,b){var c=[],e;for(e in b)c.push({location:b[e].offset,val:"\x3cstrong\x3e"}),c.push({location:b[e].offset+b[e].length,val:"\x3c/strong\x3e"});c.sort(function(a,b){return b.location-a.location});for(var g in c)b=
c[g].location,a=a.substring(0,b)+c[g].val+a.substring(b);return a}(a.description,a.matched_substrings);d.push({elementRole:0===b?"presentation":"",placeId:a.place_id,placeDescription:w(a.description),title:c})});a=b.$ui.suggest.listPanel.empty();b.invokeTemplate("suggestOption",{suggestList:d},a.get(0));a.find("li \x3e a").on("click",function(a){a=f(a.currentTarget);var c=a.attr("data-place-id"),e=a.attr("data-place-description");(new google.maps.places.PlacesService(b.gmap.map)).getDetails({placeId:c,
fields:["name","rating","formatted_phone_number","geometry"]},function(a,c){c===google.maps.places.PlacesServiceStatus.OK&&a.geometry&&(b.$ui.suggest.panel.hide(),b.$ui.search.input.val(e),b.gmap.map.setCenter(a.geometry.location),b.gmap.ctx.searchLatitude=null,b.gmap.ctx.searchLongitude=null,b.gmap.ctx.draggedLatitude=null,b.gmap.ctx.draggedLongitude=null,b.gmap.ctx.autocompleteLatitude=a.geometry.location.lat(),b.gmap.ctx.autocompleteLongitude=a.geometry.location.lng(),r())})})}}function K(a){b.$ui.search.button.attr({"an-tr":b.meta("taggingPrefix")+
"-search-"+a,"an-ac":"search result:"+a,"an-la":"keyword:"+f.trim(b.$ui.search.input.val())})}function I(a){var c={groupList:L(a.categorys),storeFilterList:V(a)};"Y"===b.config.hatchStorelocatorUseYN&&(t=a.categorys);a=function(a){setTimeout(function(){r(!0)},100)};var d=b.$ui.filter;0<c.groupList.length&&(b.invokeTemplate("categoryFilterGroup",c,d.categoryFilterPanel.empty().get(0)),d.resetCategoriesButton.on("click",a));0<c.storeFilterList.length&&(b.invokeTemplate("storeFilterItem",c,d.storeFilterPanel.empty().get(0)),
d.resetStoresButton.on("click",a));d.panel.find("input[type\x3d'checkbox']").on("click",a);d.findStoreCta.on("click",a);k(b.$ui.filter.panel.get(0))}function L(a){var b=[];if(a&&0<a.length){for(var c=new Map,e=0;e<a.length;e++){var d=a[e];if("group"===d.categoryFlag&&d.iaCode===d.groupIaCode){var g=F(d,!0);c.set(d.iaCode,g);b.push(g)}}for(e=0;e<a.length;e++)if(d=a[e],"type"===d.categoryFlag)if(g=c.get(d.groupIaCode)){var f=g.items;f||(f=g.items=[]);f.push(F(d))}else console.log("[PDD08] Unknwon category group: "+
d.groupIaCode)}return b}function O(a){var b=[];if(a&&0<a.length){for(var c=new Map,e=0;e<a.length;e++)for(var d=a[e],g=0;g<t.length;g++)if(d===t[g].iaCode&&"group"===t[g].categoryFlag&&t[g].iaCode===t[g].groupIaCode){var f=F(t[g],!0);c.set(t[g].iaCode,f);b.push(f)}for(e=0;e<a.length;e++)for(d=a[e],g=0;g<t.length;g++)if(d===t[g].iaCode&&"type"===t[g].categoryFlag)if(f=c.get(t[g].groupIaCode)){var h=f.items;h||(h=f.items=[]);h.push(F(t[g]))}else console.log("[PDD08] Unknwon category group: "+t[g].groupIaCode)}return b}
function V(a){var c=[];a=a.shopTypes;if("Y"===b.config.hatchStorelocatorUseYN){if((a=b.config.hatchStorelocatorStoreType.split("|"))&&0<a.length)for(var d=0;d<a.length;d++){var e=a[d];"1_ses"===e?c.push({code:"E",hatchcode:"1_ses",taggingName:"experience store",displayName:Granite.I18n.get("Experience Store")}):"2_sbs"===e?c.push({code:"B",hatchcode:"2_sbs",taggingName:"brand store",displayName:Granite.I18n.get("Brand Store")}):"3_retailer_store"===e?c.push({code:"O",hatchcode:"3_retailer_store",
taggingName:"others store",displayName:Granite.I18n.get("Others Store")}):""===e&&c.push({code:"O",hatchcode:"3_retailer_store",taggingName:"others store",displayName:Granite.I18n.get("Others Store")})}}else if(a&&0<a.length)for(d=0;d<a.length;d++)e=a[d],c.push({code:e.brandTypeCode,taggingName:e.brandType.toLowerCase(),displayName:Granite.I18n.get(e.brandType)});return c}function F(a,b){a={code:a.iaCode,taggingName:a.iaName.toLowerCase(),displayName:Granite.I18n.get(a.iaName)};b&&(a.taggingName=
"all "+a.taggingName);return a}function w(a){return a.replace(/"/g,"\x26quot;")}var t=null,q=new Map;q.set("E","experience");q.set("B","brand");q.set("O","other");var S={ar:"Argentina",ca:"Canada",ca_fr:"Canada",cl:"Chile",pe:"Per\u00fa",ve:"Venezuela",br:"Brasil",co:"Colombia",mx:"M\u00e9xico",au:"Australia",cn:"\u4e2d\u570b",hk:"Hong Kong",hk_en:"Hong Kong",jp:"\u65e5\u672c",id:"Indonesia","in":"India",my:"Malaysia",nz:"New Zealand",ph:"Philippines",th:"\u0e40\u0e21\u0e37\u0e2d\u0e07\u0e44\u0e17\u0e22",
tw:"\u4e2d\u83ef\u6c11\u570b",vn:"Vi\u1ec7t Nam",sg:"Singapore",ee:"Eesti",eg:"\u0645\u0635\u0631",il:"\u05d9\u05e9\u05e8\u05d0\u05dc",iran:"\u0627\u06cc\u0631\u0627\u0646",kz_ru:"\u041a\u0430\u0437\u0430\u0445\u0441\u0442\u0430\u043d",lt:"Lietuva",lv:"Latvija",sa:"\u0627\u0644\u0645\u0645\u0644\u0643\u0629 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629",ru:"\u0420\u043e\u0441\u0441\u0438\u044f",tr:"T\u00fcrkiye",ua:"\u0423\u043a\u0440\u0430\u0457\u043d\u0430",
ua_ru:"\u0423\u043a\u0440\u0430\u0457\u043d\u0430",be:"Belgi\u00eb",be_fr:"Belgique",bg:"\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f",cz:"\u010cesko",es:"Espa\u00f1a",fr:"France",gr:"\u0395\u03bb\u03bb\u03ac\u03b4\u03b1",hr:"Hrvatska",it:"Italia",nl:"Nederland",at:"\u00d6sterreich",pl:"Polska",ch:"Schweiz",ch_fr:"Suisse",pt:"Portugal",de:"Deutschland",dk:"Danmark",ro:"Rom\u00e2nia",fi:"Suomi",se:"Sverige",hu:"Magyarorsz\u00e1g",ie:"Ireland",sk:"Slovensko",no:"Norge",pk:"Pakistan",rs:"Srbija",
uk:"United Kingdom",sa_en:"Saudi Arabia",za:"South Africa",py:"Paraguay",uy:"Uruguay",ae:"UAE",ae_ar:"UAE",al:"Albania",kz_kz:"Kazakhstan",lb:"Lebanon",mk:"Macedonia",mm:"Myanmar",sec:"Korea",si:"Slovenia",us:"USA",uz_ru:"Uzbekistan",uz_uz:"Uzbekistan"},v=null,H=null,b=null;u.loadStores=function(a,b,c,d,f,g){h({siteCode:a,distanceUnit:b,latitude:c,longitude:d,nRadius:10},f,g)};u.checkStores=function(a,b,c,d){var e=!1;u.loadStores(a,b,c,d,function(a){a=A(a);e=!isNaN(a)&&0<a},!1);return e};u.showDetailLayer=
function(a){b&&b.data&&b.data.storeMap&&(a=b.data.storeMap[a])&&b.$ui.layer.detailPopup.openPopup(a.index,!0)};var W={onReady:function(){var a=b.config,f=b.gmap.ctx;T();if("Y"===a.hatchStorelocatorUseYN){var k=null!=a.hatchStorelocatorLang&&""!=a.hatchStorelocatorLang&&void 0!=a.hatchStorelocatorLang?{countryCode:a.hatchRegion,geoCenterArea:{center:{latitude:f.gpsLatitude||a.latitude,longitude:f.gpsLongitude||a.longitude},distance:1E3*parseInt(b.getCurrentRadius())},segment:a.hatchStorelocatorLang,
filters:[]}:{countryCode:a.hatchRegion,geoCenterArea:{center:{latitude:f.gpsLatitude||a.latitude,longitude:f.gpsLongitude||a.longitude},distance:1E3*parseInt(b.getCurrentRadius())},filters:[]};a={siteCode:a.siteCode,distanceUnit:a.distanceUnit,latitude:f.gpsLatitude||a.latitude,longitude:f.gpsLongitude||a.longitude,nRadius:b.getCurrentRadius()};c(a,function(a){I(a)});h(k,function(a){var b=A(a);!isNaN(b)&&0<b?d(a,b):J(k)})}else k={siteCode:a.siteCode,distanceUnit:a.distanceUnit,latitude:f.gpsLatitude||
a.latitude,longitude:f.gpsLongitude||a.longitude,nRadius:b.getCurrentRadius()},h(k,function(a){var b=A(a);!isNaN(b)&&0<b?(I(a),d(a,b)):J(k)});b.$ui.search.reset.on("click",function(){setTimeout(function(){b.$ui.search.input.val("");b.gmap.ctx.autocompleteLatitude=null;b.gmap.ctx.autocompleteLongitude=null;b.gmap.ctx.searchLatitude=null;b.gmap.ctx.searchLongitude=null;b.gmap.ctx.draggedLatitude=null;b.gmap.ctx.draggedLongitude=null;C()},100)});var e=null;b.gmap.map.addListener("center_changed",function(){var a=
b.gmap.map.getCenter();b.gmap.location=a});b.gmap.map.addListener("dragend",function(){b.gmap.ctx.tooltipActivated||(e&&clearTimeout(e),e=setTimeout(r(!0),500));b.$ui.layer.detailPopup.currentStore&&G(b.$ui.layer.detailPopup.currentStore.index)});a=b.$ui.layer.detailPopup;a.openPopup=function(a,c){G(a,!0);a=b.$ui.layer.detailPopup;a.attr("tabindex","0");a.show().focus()};a.closePopup=function(){var a=b.$ui.layer.detailPopup,c=a.currentStore;a.hide();a.currentStore=null;b.notify("storeDetailClosed",
c)}}},N={onAfterInit:function(a){var c=f.trim(f("input#searchDomain").val()),d=f.trim(f("input#apiStageInfo").val());"Y"===a.config.hatchStorelocatorUseYN?(v=a.config.hatchStorelocatorUrl+a.config.hatchStorelocatorBrandID,H=c+"/"+d):v=c+"/"+d;b=a;a.addObserver(W)}};x.attachListener(".pd-store-locator.sdf-dynamic-component",N);f(function(){0===f(".pd-store-locator.sdf-dynamic-component").length&&x.detachListener(".pd-store-locator.sdf-dynamic-component",N)})})(jQuery,window.sg.components.pfStoreLocator,
window.sg.sdf.comp);